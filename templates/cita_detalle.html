{% extends "base.html" %}

{% block title %}{{ cita.nombre }} - Our Adventures{% endblock %}

{% block content %}
<div class="detail-page">
    <a href="{{ url_for('citas') }}" class="back-button">â† Volver a Citas</a>
    
    <div class="page-header">
        <h1>ğŸ’• {{ cita.nombre }}</h1>
    </div>

    <!-- BOTONES MODIFICAR -->
    <div style="display: flex; gap: 12px; margin: 20px 0; flex-wrap: wrap;">
        <a href="{{ url_for('edit_cita', id=cita.id) }}" class="btn-secondary" style="text-decoration: none;">
            âœï¸ Modificar
        </a>
    </div>
    
    <div class="detail-header">
        <!-- PORTADA PERSONALIZADA O PLACEHOLDER -->
        {% if cita.imagen and cita.imagen != 'default.jpg' %}
            <div class="detail-image-container">
                <img 
                    src="{{ url_for('static', filename='uploads/citas/' + cita.imagen) }}" 
                    alt="{{ cita.nombre }}"
                    class="detail-image"
                    style="width: 100%; height: 100%; object-fit: cover;">
            </div>
        {% else %}
            <div class="detail-image-container" style="background: linear-gradient(135deg, #f0ebe5 0%, #d4c4b0 100%); display: flex; align-items: center; justify-content: center;">
                <div style="text-align: center;">
                    <div style="font-size: 3em; margin-bottom: 12px;">ğŸ’•</div>
                    <small style="color: #626c7c;">Sin portada</small>
                </div>
            </div>
        {% endif %}
        
        <div class="detail-info">
            <h1>{{ cita.nombre }}</h1>
            
            <div class="location-detail">
                ğŸ“ <strong>UbicaciÃ³n:</strong><br>
                {{ cita.ubicacion }}
            </div>
            
            {% if cita.fecha %}
            <div class="date-detail">
                ğŸ“… <strong>Fecha:</strong><br>
                {{ cita.fecha }}
            </div>
            {% endif %}
            
            <div class="status-indicator {% if cita.realizada == 'True' or cita.realizada == 'true' %}completed{% else %}pending{% endif %}">
                {% if cita.realizada == 'True' or cita.realizada == 'true' %}
                    âœ“ Realizada
                {% else %}
                    â—‹ Pendiente
                {% endif %}
            </div>
        </div>
    </div>

    <!-- GALERÃA GOOGLE FOTOS - SOLO LINK -->
    <div class="section">
        <h2>ğŸ“¸ GalerÃ­a de Fotos</h2>
        <p style="color: var(--color-text-secondary); margin-bottom: 20px;">
            Comparte un Ã¡lbum de Google Fotos para ver tus fotos
        </p>

        <!-- Formulario para guardar enlace -->
        <div style="padding: 20px; background: var(--color-secondary); border-radius: 12px; margin-bottom: 24px;">
            <h3 style="color: var(--color-text); margin-bottom: 12px;">ğŸŒ Tu Ãlbum de Google Fotos</h3>
            
            <form method="POST" action="{{ url_for('save_cita_google_photos', id=cita.id) }}">
                <div style="display: flex; gap: 12px; margin-bottom: 12px;">
                    <input type="text" name="google_photos_link" placeholder="https://photos.google.com/share/..."
                        value="{{ cita.google_photos_link or '' }}"
                        style="flex: 1; padding: 12px; border: 1px solid var(--color-border); border-radius: 8px; font-size: 0.95em;">
                    <button type="submit" class="btn-primary" style="padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; white-space: nowrap;">
                        ğŸ’¾ Guardar
                    </button>
                </div>
                <small style="color: var(--color-text-secondary); font-size: 0.85em; display: block;">
                    ğŸ’¡ Google Fotos â†’ Ãlbum â†’ Compartir â†’ Crear enlace â†’ Copia y pega aquÃ­
                </small>
            </form>
        </div>

        <!-- Mostrar enlace guardado y botÃ³n -->
        {% if cita.google_photos_link %}
            <div style="padding: 20px; background: var(--color-surface); border-radius: 12px; border: 1px solid var(--color-border); text-align: center;">
                <p style="color: var(--color-text); margin: 0 0 16px 0; font-weight: 600;">âœ“ Ãlbum conectado</p>
                
                <a href="{{ cita.google_photos_link }}" target="_blank" 
                   style="display: inline-block; padding: 14px 32px; background: var(--color-primary); color: white; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 1.1em; transition: all 0.3s ease; margin-bottom: 16px;"
                   onmouseover="this.style.opacity='0.9'; this.style.transform='scale(1.05)'"
                   onmouseout="this.style.opacity='1'; this.style.transform='scale(1)'">
                    ğŸ“¸ Ver Ãlbum Completo
                </a>

                <div style="margin-top: 16px; padding: 12px; background: var(--color-secondary); border-radius: 8px; border-left: 3px solid var(--color-primary);">
                    <p style="color: var(--color-text-secondary); margin: 0; font-size: 0.85em; word-break: break-all;">
                        {{ cita.google_photos_link }}
                    </p>
                </div>
            </div>
        {% else %}
            <div style="text-align: center; padding: 40px 20px; background: var(--color-surface); border-radius: 12px; border: 2px dashed var(--color-border);">
                <p style="font-size: 2em; margin-bottom: 12px;">ğŸ“¸</p>
                <p style="color: var(--color-text-secondary); margin: 0;">
                    Sin galerÃ­a conectada aÃºn.<br>
                    <strong style="color: var(--color-text);">Pega el enlace de tu Ã¡lbum arriba</strong>
                </p>
            </div>
        {% endif %}
    </div>

</div>

{% endblock %}
